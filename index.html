<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Sherin ‚Äî –¢–∞–±–ª–∏—Ü–∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #4158d0, #c850c0, #ffcc70);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    .wrap-table100 {
      background: #fff;
      width: 100%;
      max-width: 100%;   /* –±—ã–ª–æ 1200px ‚Äî —É–±–∏—Ä–∞–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ */
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,.12);
      overflow-x: auto;  /* —á—Ç–æ–±—ã –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–ª–∞—Å—å */
      margin-top: 15px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      table-layout: auto; /* –ø—É—Å—Ç—å –∫–æ–ª–æ–Ω–∫–∏ —Å–∞–º–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è */
      min-width: unset;   /* —É–±—Ä–∞–ª–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ 600px */
    }
    thead {
      background: #111;
      color: #fff;
    }
    th, td {
      border: 1px solid #eee;
      padding: 10px 15px;
      text-align: left;
      word-break: break-word;
    }
    td[contenteditable="true"] {
      background: #f9f9ff;
    }
    tr:nth-child(even) td { background: #fafafa; }
    button {
      padding: 6px 12px;
      background: #4158d0;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: 0.2s;
    }
    button:hover {
      background: #2e3ba8;
    }
    .btn-delete { background: #e74c3c; }
    .btn-delete:hover { background: #c0392b; }
    .btn-save { background: #27ae60; display: none; }
    .btn-save:hover { background: #1e8449; }
    .row-inserter td {
      text-align: center;
      padding: 4px;
      border: none;
    }
    .btn-insert {
      display: none;
      background: #3498db;
      border-radius: 50%;
      padding: 4px 8px;
      font-size: 16px;
    }
    .row-inserter:hover .btn-insert { display: inline-block; }
    @media (max-width: 768px) {
      th, td { padding: 6px; font-size: 13px; }
      button { font-size: 12px; padding: 4px 8px; }
    }
  </style>
</head>
<body>
  <h1 style="color:white;">üìä –¢–∞–±–ª–∏—Ü–∞ —Å–∫–ª–∞–¥–∞</h1>
  <div class="wrap-table100">
    <table id="excel-table">
      <thead></thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    let tableData = [];

    async function loadExcel() {
      try {
        let response = await fetch("data.xlsx"); 
        if (!response.ok) throw new Error("–ù–µ—Ç data.xlsx, –±—É–¥–µ—Ç –ø—É—Å—Ç–∞—è —Ç–∞–±–ª–∏—Ü–∞");

        let arrayBuffer = await response.arrayBuffer();
        let workbook = XLSX.read(arrayBuffer, { type: "array" });
        let sheetName = workbook.SheetNames[0];
        let worksheet = workbook.Sheets[sheetName];
        tableData = XLSX.utils.sheet_to_json(worksheet, { header: 1, defval: "" });
      } catch (err) {
        console.warn(err.message);
        tableData = [["–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ", "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ", "–¶–µ–Ω–∞"]];
      }
      renderTable(tableData);
    }

    function renderTable(data) {
      let thead = document.querySelector("#excel-table thead");
      let tbody = document.querySelector("#excel-table tbody");
      thead.innerHTML = "";
      tbody.innerHTML = "";

      if (data.length > 0) {
        let headerRow = document.createElement("tr");
        data[0].forEach(col => {
          let th = document.createElement("th");
          th.textContent = col;
          headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);
      }

      for (let i = 1; i < data.length; i++) {
        let row = document.createElement("tr");
        data[i].forEach(cell => {
          let td = document.createElement("td");
          td.textContent = cell;
          row.appendChild(td);
        });
        tbody.appendChild(row);
      }
    }

    loadExcel();
  </script>
</body>
</html>
